<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
<script async src="http://127.0.0.1:8000/stats-config.js?siteId=35f3fc7f-338f-457e-9186-d8f928dd5e18&siteKey=wNV_OZzyUZueH2Hnjt2T7A"></script></head>
<link>
<body style="font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 0;">
  <header style="position: sticky; top: 0; background: #111; color: #f4f4f4; padding: 16px; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">
    <h1 style="margin: 0; font-size: 20px;">Long Scroll Test Page</h1>
    <p style="margin: 4px 0 0; font-size: 13px;">Use this page to generate scroll, clicks, and engagement signals.</p>
  </header>

  <main style="max-width: 780px; margin: 0 auto; padding: 24px;">
    <p><a href="https://google.com">Google</a> | <a href="https://example.com">Example</a> | <a href="#">Top</a></p>
    <section>
      <h2>Intro</h2>
      <p>This page is intentionally long to help trigger scroll depth, idle time, and engagement tracking from the SDK. Keep scrolling to the bottom and interact with the buttons sprinkled throughout.</p>
    </section>

    <section>
      <h2>Content Blocks</h2>
      <p>Block 1: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque vitae nisi eget dolor gravida pulvinar. Curabitur auctor metus a sapien consequat, ut fermentum lacus ultricies.</p>
      <p>Block 2: Sed posuere, sem ac aliquam auctor, augue magna luctus dui, at facilisis justo ligula eu ipsum. Integer eget mauris ullamcorper, interdum ante at, tempus dui.</p>
      <p>Block 3: Vivamus tempor, eros vel blandit aliquam, lorem nisl luctus mi, non tincidunt enim turpis vitae odio. Integer posuere nisl sit amet sem commodo pretium.</p>
      <p>Block 4: Quisque quis ligula ipsum. Suspendisse potenti. Nam sodales justo eu massa convallis, quis laoreet urna tempor.</p>
      <p>Block 5: Nunc semper, magna non maximus viverra, lorem nisl malesuada nisi, at fermentum elit justo ut augue. Donec et sapien sed justo viverra rhoncus.</p>
    </section>

    <section>
      <h2>Scrollable Filler</h2>
      <p>Filler 1: Cras nec arcu ac neque dapibus placerat. Proin pulvinar, libero vitae facilisis imperdiet, nibh nibh malesuada justo, sit amet porta mauris libero et erat.</p>
      <p>Filler 2: Suspendisse dictum, enim vitae fermentum sodales, nisi lectus cursus neque, id malesuada mi magna vel nunc. Nullam sed leo maximus, vulputate lacus nec, consequat sem.</p>
      <p>Filler 3: Ut imperdiet sapien eget pharetra iaculis. Phasellus eget dolor ac urna gravida convallis sit amet eget justo.</p>
      <p>Filler 4: Nam ut turpis vitae urna volutpat mattis. Duis volutpat lacinia arcu, vitae ultrices risus luctus id.</p>
      <p>Filler 5: Integer suscipit diam id tellus hendrerit, vitae congue lacus volutpat. Etiam dapibus venenatis magna, sit amet bibendum elit varius sed.</p>
      <p>Filler 6: Proin sagittis, neque nec viverra pharetra, elit erat gravida justo, eget luctus lorem leo vitae lorem.</p>
      <p>Filler 7: Curabitur convallis arcu sit amet dolor cursus, ac suscipit nulla facilisis. Vivamus egestas mauris non auctor dignissim.</p>
      <p>Filler 8: Mauris viverra, augue id facilisis congue, ipsum dolor faucibus lorem, eu interdum enim magna non justo.</p>
      <p>Filler 9: Aenean et nibh vel velit porta efficitur. Vestibulum et lacus quam. Integer convallis arcu felis, ut cursus nisl posuere sed.</p>
      <p>Filler 10: Fusce nec dolor blandit, tincidunt lorem vel, fermentum sapien. Sed eu leo vel odio laoreet sagittis.</p>
      <p>Filler 11: Vestibulum sed risus turpis. Aliquam dictum mi vel lectus lobortis, ut bibendum justo aliquet.</p>
      <p>Filler 12: Morbi euismod augue a venenatis dapibus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>
      <p>Filler 13: Etiam maximus urna non ultrices venenatis. Cras egestas dolor vitae velit dignissim ultricies.</p>
      <p>Filler 14: Praesent ac turpis accumsan, faucibus ex vitae, convallis odio. Integer tempus nulla at augue luctus placerat.</p>
      <p>Filler 15: Vestibulum ut massa porta, efficitur purus ut, fringilla sapien. Cras posuere lacinia ante, a posuere risus lacinia id.</p>
      <p>Filler 16: Sed ac tellus in turpis dapibus dapibus nec vitae tortor. Vestibulum dictum elit eget varius placerat.</p>
      <p>Filler 17: Mauris in dolor in tortor faucibus dignissim. Sed consequat vulputate odio, vel placerat urna porta a.</p>
      <p>Filler 18: Pellentesque fermentum justo sit amet velit condimentum, in tempus dui cursus. Etiam sit amet fringilla lectus.</p>
      <p>Filler 19: Donec hendrerit, lectus a aliquet hendrerit, lorem erat mattis arcu, nec faucibus nisi justo eget ligula.</p>
      <p>Filler 20: Cras blandit, nibh non facilisis ornare, libero libero lobortis nunc, at varius erat nibh non mi.</p>
      <p>Filler 21: Morbi accumsan lorem sit amet eros fermentum, at cursus nisi sollicitudin. Integer at semper lorem.</p>
      <p>Filler 22: Vivamus porta risus vitae mi porttitor, non faucibus nibh porttitor. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae.</p>
      <p>Filler 23: Aliquam erat volutpat. Duis a tempor mi. Sed faucibus finibus massa, at tempus libero viverra eu.</p>
      <p>Filler 24: Integer faucibus lorem non cursus volutpat. Phasellus id pretium risus, sed feugiat leo.</p>
      <p>Filler 25: Nam commodo velit ac elit iaculis, sed interdum massa vulputate. Sed malesuada pharetra justo, ut lacinia neque.</p>
      <p>Filler 26: Aenean interdum felis vitae risus vulputate, non convallis tellus porta. Donec et magna nec est fermentum porttitor.</p>
      <p>Filler 27: Praesent ac facilisis metus. Curabitur sollicitudin tellus sed diam iaculis, vitae semper est dapibus.</p>
      <p>Filler 28: Maecenas nec justo ligula. Pellentesque pretium arcu elit, in consequat leo facilisis vitae.</p>
      <p>Filler 29: Etiam sodales nibh eu mi fermentum, vel faucibus augue cursus. Nulla facilisi.</p>
      <p>Filler 30: Integer sed orci vitae lectus tristique tempus. Sed ultrices metus a arcu aliquet volutpat.</p>
      <p>Filler 31: Suspendisse ut dapibus nisl. Nam suscipit, sem vitae interdum malesuada, eros nisi vestibulum tortor, vitae commodo felis elit id lacus.</p>
      <p>Filler 32: Integer luctus commodo est at finibus. Pellentesque aliquam, risus eu finibus auctor, enim sapien mattis augue, sit amet semper velit justo a nunc.</p>
      <p>Filler 33: Donec scelerisque justo non augue cursus molestie. Phasellus semper nisl in libero volutpat, vitae dictum turpis bibendum.</p>
      <p>Filler 34: Praesent pharetra turpis neque, quis viverra magna fermentum eget. Nullam bibendum consectetur nunc, nec semper leo iaculis eu.</p>
      <p>Filler 35: Morbi luctus, lorem vitae consectetur varius, augue enim aliquam quam, ac interdum ante lorem nec massa.</p>
      <p>Filler 36: Aliquam non lectus vel justo ullamcorper sagittis. Sed malesuada nulla nec eros vestibulum, quis viverra ante tempus.</p>
      <p>Filler 37: Nam feugiat magna id mi aliquam, vitae cursus tortor volutpat. Cras tempor porta mauris, nec viverra est tristique at.</p>
      <p>Filler 38: Integer finibus facilisis tellus, vitae egestas sem congue eget. Quisque facilisis diam a eros feugiat congue.</p>
      <p>Filler 39: Curabitur feugiat, metus vitae vestibulum faucibus, orci justo mattis erat, id aliquet odio arcu ut urna.</p>
      <p>Filler 40: Sed interdum augue id massa congue, in faucibus lectus pulvinar. Mauris vitae ipsum vel mi semper varius.</p>
    </section>

    <section style="margin-top: 24px; padding: 16px; background: #f5f5f5; border: 1px solid #ddd;">
      <h2>Interactive Bits</h2>
      <button onclick="alert('Button clicked')" style="padding: 10px 16px; margin-right: 8px;">Click Me</button>
      <button onclick="window.scrollTo({ top: 0, behavior: 'smooth' });" style="padding: 10px 16px;">Back to Top</button>
      <p style="margin-top: 12px;">These buttons are here to generate click events and test idle/scroll behavior.</p>
    </section>

    <section style="margin-top: 24px; padding: 16px; background: #eef7ff; border: 1px solid #c4ddff;">
      <h2>Engagement Lab</h2>
      <p>Use these controls to trigger every engagement metric:</p>
      <form id="demo-form" style="display: grid; gap: 8px; max-width: 360px; margin-top: 12px;">
        <label>First Name <input name="first" required style="width: 100%; padding: 8px;"></label>
        <label>Email <input type="email" name="email" required style="width: 100%; padding: 8px;"></label>
        <label>Feedback <textarea name="fb" rows="3" style="width: 100%; padding: 8px;"></textarea></label>
        <button type="submit" style="padding: 10px 16px;">Submit Form</button>
      </form>
      <div style="margin-top: 16px;">
        <video id="demo-video" width="360" controls style="border: 1px solid #ccc;">
          <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
        </video>
        <p style="font-size: 13px; color: #555;">Play the video and scrub a bit to generate watch time.</p>
      </div>
      <div style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap;">
        <button id="send-engagement" type="button" style="padding: 10px 16px;">Send Engagement Snapshot</button>
        <button id="reset-counters" type="button" style="padding: 10px 16px;">Reset Local Counters</button>
      </div>
      <p id="status" style="margin-top: 10px; font-size: 13px; color: #0a5;">Status: idle</p>
    </section>
  </main>

  <script>
    // Minimal helper to simulate full engagement payloads against /ingest
    const SITE_ID = '35f3fc7f-338f-457e-9186-d8f928dd5e18';
    const SITE_KEY = 'wNV_OZzyUZueH2Hnjt2T7A';
    const INGEST_URL = 'http://127.0.0.1:8000/ingest';

    let clicksCount = 0;
    let formStarted = false;
    let formCompleted = false;
    let videoStarted = false;
    let videoWatchMs = 0;
    let videoLastStart = null;
    const sessionStart = Date.now();

    document.addEventListener('click', () => clicksCount++);
    document.addEventListener('mousemove', () => {}); // keeps mouse activity flowing
    document.addEventListener('keydown', () => {});

    const formEl = document.getElementById('demo-form');
    formEl.addEventListener('focusin', () => { formStarted = true; }, { once: true });
    formEl.addEventListener('submit', (e) => {
      e.preventDefault();
      formCompleted = true;
      document.getElementById('status').textContent = 'Status: form submitted';
    });

    const videoEl = document.getElementById('demo-video');
    videoEl.addEventListener('play', () => {
      videoStarted = true;
      videoLastStart = Date.now();
    });
    videoEl.addEventListener('pause', () => {
      if (videoLastStart) {
        videoWatchMs += Date.now() - videoLastStart;
        videoLastStart = null;
      }
    });
    videoEl.addEventListener('ended', () => {
      if (videoLastStart) {
        videoWatchMs += Date.now() - videoLastStart;
        videoLastStart = null;
      }
    });

    function currentScrollPercent() {
      const scrollTop = window.scrollY + window.innerHeight;
      const height = document.documentElement.scrollHeight || document.body.scrollHeight || 1;
      return Math.min(100, Math.round((scrollTop / height) * 100));
    }

    async function sendEngagementSnapshot() {
      const timeOnPageSec = (Date.now() - sessionStart) / 1000;
      if (videoLastStart) {
        videoWatchMs += Date.now() - videoLastStart;
        videoLastStart = Date.now();
      }
      const payload = {
        site_id: SITE_ID,
        ts: new Date().toISOString(),
        visitor_id: localStorage.getItem('analytiq_visitor_id') || 'dev-visitor',
        session_id: localStorage.getItem('analytiq_session_id') || 'dev-session',
        url: window.location.href,
        scroll_depth_percent: currentScrollPercent(),
        time_on_page_sec: timeOnPageSec,
        clicks_count: clicksCount,
        idle_time_sec: 0,
        mouse_movements: 0,
        keyboard_events: 0,
        form_started: formStarted,
        form_completed: formCompleted,
        video_played: videoStarted,
        video_watch_time_sec: Math.round(videoWatchMs / 1000),
        type: 'engagement'
      };

      document.getElementById('status').textContent = 'Status: sending...';

      try {
        await fetch(INGEST_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'x-site-id': SITE_ID,
            'x-site-key': SITE_KEY
          },
          body: JSON.stringify(payload)
        });
        document.getElementById('status').textContent = 'Status: snapshot sent';
      } catch (err) {
        document.getElementById('status').textContent = 'Status: send failed';
        console.error(err);
      }
    }

    function resetCounters() {
      clicksCount = 0;
      formStarted = false;
      formCompleted = false;
      videoStarted = false;
      videoWatchMs = 0;
      videoLastStart = null;
      document.getElementById('status').textContent = 'Status: counters reset';
    }

    document.getElementById('send-engagement').addEventListener('click', sendEngagementSnapshot);
    document.getElementById('reset-counters').addEventListener('click', resetCounters);
  </script>
</body>

</html>